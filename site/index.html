<!DOCTYPE html>
<html>
<head>
<title>LRDraw</title>

</head>
<body>
    <canvas>
      What, no canvas support? D:
    </canvas>
	
 <script>
	"use strict";
	window.a = document.getElementsByTagName('canvas')[0];
	window.b = document.getElementsByTagName('body')[0];
	window.c = window.a.getContext('2d');
	window.d = document;
	
	var g = {};
	a.width = window.innerWidth;
	a.height = window.innerHeight;
	 
	g.w = window.innerWidth;
	g.h = window.innerHeight;
	g.r = 24;
	g.s = 8;
	g.fr = 100;
	g.color = '0';
	g.tmp = [
			[
				["B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","k","k","B","B","B","B","B","B"],
				["B","b","b","b","b","b","B","c","c","c","c","c","B","B","y","y","y","y","k","B","B","B","B","B"],
				["B","B","b","B","B","B","B","c","B","B","B","c","B","B","k","k","k","k","y","B","B","B","B","B"],
				["B","B","B","b","B","B","B","c","B","B","B","c","B","B","y","y","y","y","k","B","B","B","B","B"],
				["B","B","b","B","B","B","B","c","B","B","B","c","B","B","k","k","k","k","y","B","B","B","B","B"],
				["B","b","b","b","b","b","B","B","c","c","c","c","B","B","y","y","y","y","k","B","B","B","B","B"],
				["B","B","B","B","B","B","B","B","k","B","B","B","B","B","k","k","B","k","k","B","B","B","B","B"],
				["B","r","r","r","r","r","B","g","g","g","g","g","B","B","b","b","b","b","b","B","B","B","B","B"],
				["B","B","B","B","B","B","B","B","B","B","B","B","B","B","b","k","b","B","b","B","B","B","B","B"],
				["B","B","y","y","y","B","B","p","p","p","p","p","B","B","b","B","k","k","b","B","B","B","B","B"],
				["B","y","B","B","B","y","B","p","B","p","B","p","B","B","b","B","k","k","b","B","B","B","B","B"],
				["B","y","B","B","B","y","B","p","B","B","B","p","B","B","k","B","B","k","k","B","B","B","B","B"],
				["B","y","B","B","B","y","B","p","B","B","B","p","B","B","r","r","r","r","r","B","B","B","B","B"],
				["B","B","B","B","B","B","B","B","B","B","B","B","B","B","r","k","r","B","r","B","B","B","B","B"],
				["B","g","g","g","g","g","B","B","w","w","w","w","B","B","r","B","r","B","r","B","B","B","B","B"],
				["B","B","B","g","B","B","B","w","B","B","B","w","B","B","k","r","k","r","k","B","B","B","B","B"],
				["B","B","B","g","B","B","B","w","B","B","B","w","B","B","B","k","B","k","B","B","B","B","B","B"],
				["B","g","g","g","g","g","B","w","B","w","B","w","B","B","B","k","B","B","B","B","B","B","B","B"],
				["B","B","B","B","B","B","B","B","B","w","w","w","B","B","B","B","B","B","B","B","B","B","B","B"],
				["B","p","p","p","p","p","B","B","B","B","B","B","B","B","c","c","c","c","c","B","B","B","B","B"],
				["B","p","B","p","B","p","B","k","b","b","b","k","B","B","c","B","B","B","c","B","B","B","B","B"],
				["B","p","B","B","B","p","B","b","B","B","B","b","B","B","c","B","B","B","c","B","B","B","B","B"],
				["B","p","B","B","B","p","B","b","B","B","B","b","B","B","c","B","B","B","c","B","B","B","B","B"],
				["B","B","B","B","B","B","B","b","k","k","B","b","B","B","B","c","c","c","c","B","B","B","B","B"],
				["B","c","c","c","c","c","B","B","b","b","b","B","B","B","B","B","B","B","B","B","B","B","B","B"],
				["B","B","B","B","B","c","B","B","k","B","B","B","B","B","p","p","p","p","p","B","B","B","B","B"],
				["B","B","B","B","B","c","B","y","y","y","y","y","B","B","p","B","p","B","p","B","B","B","B","B"],
				["B","B","B","B","B","c","B","B","B","B","B","y","B","B","p","B","B","B","p","B","B","B","B","B"],
				["B","B","B","B","B","B","B","B","B","B","B","y","B","B","p","B","B","B","p","B","B","B","B","B"],
				["B","w","w","w","w","w","B","B","B","B","B","y","B","B","B","B","B","B","k","B","B","B","B","B"],
				["B","w","B","w","B","w","B","B","B","B","B","k","B","B","g","g","g","B","B","B","B","B","B","B"],
				["B","w","B","B","B","w","B","r","r","r","r","r","B","B","B","B","B","g","B","B","B","B","B","B"],
				["B","w","B","B","B","w","B","B","B","B","B","B","B","B","B","B","B","B","g","B","B","B","B","B"],
				["B","k","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","g","B","B","B","B","B","B"],
				["B","B","B","B","B","B","B","B","B","B","B","B","B","B","g","g","g","B","B","B","B","B","B","B"],
				["B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B"],
				["B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B"],
				["B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B"]
			],
		0];
	g.textimage = g.tmp[0];
	g.background = g.tmp[1];
	g.level = 1;
	 
	let touch = (e) =>
	 {
		let x = e.originalEvent.touches[0].pageX;
		let y = e.originalEvent.touches[0].pageY;
		down(x,y); 	
	 }
	
	 a.ontouchstart = (e) =>
	 {
		touch(e);
	 }
  
	 let mouse = (e) =>
	 {
		let x = e.clientX;
		let y = e.clientY;
		down(x,y);
	 }
  
	 a.onmousedown = (e) =>
	 {
		g.draw = true;
		  mouse(e);
	 }
	 a.ontouchmove = (e) =>
	 {
		touch(e);
	 }
	 a.onmousemove = (e) =>
	 {
		if(g.draw)
		  mouse(e);
	 }
	 a.onmouseup = (e) =>
	 {
		g.draw = false;
	 }
	 g.set_foreground_background = (color) =>
	 {
		 if(g.level === 1)
		 {
			g.color = color;
		 }else
		 {
			g.background = color;
			dr();
		 }
	 }
	 
	 d.onkeydown = (e) =>
	 {
		switch(e.key)
		{
			case 'k':
				g.set_foreground_background('0');
	 			break;
			case 'r':
				g.set_foreground_background('1');
				break;
			case 'g':
				g.set_foreground_background('2');
				break;
			case 'b':
				g.set_foreground_background('3');
				break;
			case 'y':
				g.set_foreground_background('4');
				break;
			case 'p':
				g.set_foreground_background('5');
				break;
			case 'c':
				g.set_foreground_background('6');
				break;
			case 'w':
				g.set_foreground_background('7');
				break;
			case 'c':
				gr();
				dr();
				break;
			case 'd':
				g.level = 0;
				break;
			case 'e':
				g.color = g.background;
				break;
			case 'f':
				g.level = 1;
				break;			
		}
	 }
	 
	 function down(x,y){
		 if(g.level === 1)
		 {
			let cx = Math.floor(x/g.o);
			let cy = Math.floor(y/g.o);
			g.textimage[cx][cy] = g.color;
			c.fillStyle = "#"+g.fromCharToColorHex(g.color);
			c.fillRect(cx*g.o,cy*g.o,g.o,g.o); 
		 }
			
	 }; 
		 
	//create grid 
	function gr(){
		var w = g.w;
		var h = g.h;
		var ox, oy = 0;
		if(h<w){
			ox = Math.round(h/g.r);
			g.ry = Math.round(h/ox);
			g.rx = Math.round(w/ox);
		}else{
			ox = Math.round(w/g.r);
			g.rx = Math.round(w/ox);
			g.ry = Math.round(h/ox);
		}
		g.o = ox;
		var rx = g.rx;
		var ry = g.ry;
		/*
		for(var i = 0;i<rx;i++){
			g.textimage[i] = [];
			for(var d = 0;d<ry;d++){
				//qui setta il fb
				g.textimage[i][d] = 'B';
			}
		}
		*/
		/*
		var x = Math.floor(Math.random() * (g.rx-g.s));
		var y = Math.floor(Math.random() * (g.ry-g.s));
		for(var xo = 0;xo<g.s;xo++)
		{
			for(var yo = 0;yo<g.s;yo++)
			{
				if(g.sh[yo][xo] === 'W')
					g.fb[x+xo][y+yo] = ['FF','FF','FF'];
			}
		}
		*/
		
	}
	
	g.fromCharToColorHex = (c) =>
	{
		switch(c)
		{
			case 'k':
				return '000000';
			case 'r':
				return 'FF0000';
			case 'g':
				return '00FF00';
			case 'b':
				return '0000FF';
			case 'y':
				return 'FFFF00';
			case 'p':
				return 'FF00FF';
			case 'c':
				return '00FFFF';
			case 'w':
				return 'FFFFFF';
			case 'B':
				return g.fromCharToColorHex(g.background);
		}
	}
	 
	function dr(){
		
		var rx = g.rx;
		var ry = g.ry;
		var o = g.o;
		var cx = 0, cy = 0;
		for(var i = 0;i<rx;i++){
			for(var d = 0;d<ry;d++){
				if(g.textimage[i][d])
					c.fillStyle = "#"+g.fromCharToColorHex(g.textimage[i][d]);
				else
					c.fillStyle = "#"+g.fromCharToColorHex('B');
				c.fillRect(cx,cy,o,o);
				cy += o;
			}
			cx += o;
			cy = 0;
		}
		
		
	}
  
	 gr();
   dr();
 </script>
</body></html>
